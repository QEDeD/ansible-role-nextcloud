{#
SPDX-FileCopyrightText: 2023 MASH project contributors
SPDX-FileCopyrightText: 2023 Slavi Pantaleev
SPDX-FileCopyrightText: 2025 Suguru Hirahara

SPDX-License-Identifier: AGPL-3.0-or-later
#}

{#
  See: https://github.com/docker-library/docs/blob/master/nextcloud/README.md#auto-configuration-via-environment-variables
  Note `NEXTCLOUD_ADMIN_USER` and `NEXTCLOUD_ADMIN_PASSWORD` are effective only if a group of values for the database are specified before the first run.
#}

{% if nextcloud_database_type == 'mysql' %}
MYSQL_HOST={{ nextcloud_database_mysql_hostname }}:{{ nextcloud_database_mysql_port }}
MYSQL_USER={{ nextcloud_database_mysql_username }}
MYSQL_PASSWORD={{ nextcloud_database_mysql_password }}
MYSQL_DATABASE={{ nextcloud_database_name }}

NEXTCLOUD_ADMIN_USER={{ nextcloud_environment_variables_nextcloud_admin_user }}
NEXTCLOUD_ADMIN_PASSWORD={{ nextcloud_environment_variables_nextcloud_admin_password }}
{% endif %}

{% if nextcloud_database_type == 'postgres' %}
POSTGRES_HOST={{ nextcloud_database_hostname }}:{{ nextcloud_database_port }}
POSTGRES_USER={{ nextcloud_database_username }}
POSTGRES_PASSWORD={{ nextcloud_database_password }}
POSTGRES_DB={{ nextcloud_database_name }}

NEXTCLOUD_ADMIN_USER={{ nextcloud_environment_variables_nextcloud_admin_user }}
NEXTCLOUD_ADMIN_PASSWORD={{ nextcloud_environment_variables_nextcloud_admin_password }}
{% endif %}

{% if nextcloud_database_type == 'sqlite' %}
SQLITE_DATABASE={{ nextcloud_database_name }}

NEXTCLOUD_ADMIN_USER={{ nextcloud_environment_variables_nextcloud_admin_user }}
NEXTCLOUD_ADMIN_PASSWORD={{nextcloud_environment_variables_nextcloud_admin_password }}
{% endif %}

{% if nextcloud_redis_hostname %}
REDIS_HOST={{ nextcloud_redis_hostname }}
REDIS_HOST_PORT={{ nextcloud_redis_port }}
REDIS_HOST_PASSWORD={{ nextcloud_redis_password }}
{% endif %}

NEXTCLOUD_TRUSTED_DOMAINS={{ nextcloud_environment_variables_nextcloud_trusted_domains }}

{{ nextcloud_environment_variables_additional_variables }}
